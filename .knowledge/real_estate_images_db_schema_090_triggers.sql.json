{"is_source_file": true, "format": "SQL", "description": "This file contains PostgreSQL PL/pgSQL functions and scripts related to database triggers and auditing, specifically for setting update timestamps, soft deletion, and logging read access. It includes trigger definitions, dynamic trigger creation for tables with 'updated_at' columns, and an audit logging function conditional on feature flags.", "external_files": ["information_schema.columns", "pg_trigger", "config.feature_flags", "audit.data_access_log"], "external_methods": ["format()", "NEW.updated_at", "EXECUTE format()", "coalesce()", "SELECT enabled FROM config.feature_flags"], "published": ["core.set_updated_at()", "audit.log_read()"], "classes": [], "methods": [{"name": "core.set_updated_at()", "description": "A trigger function to automatically set the 'updated_at' timestamp to the current time upon row update."}, {"name": "audit.log_read()", "description": "A function to log read access to tables, conditioned on a feature flag, storing details such as actor, IP, and user agent."}], "calls": ["format()", "EXECUTE format()", "coalesce()", "SELECT enabled FROM config.feature_flags", "INSERT INTO audit.data_access_log"], "search-terms": ["set_updated_at trigger", "audit log read", "soft delete", "dynamic trigger creation", "multitenant audit", "pg_trigger", "information_schema.columns"], "state": 2, "file_id": 18, "knowledge_revision": 37, "git_revision": "", "hash": "63d314b00ddda87c0440699e5122e710", "format-version": 4, "code-base-name": "real_estate_images_db", "filename": "real_estate_images_db/schema/090_triggers.sql", "revision_history": [{"37": ""}]}